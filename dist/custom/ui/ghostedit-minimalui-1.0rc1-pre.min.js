/*! GhostEdit WYSIWYG editor Copyright (c) 2010-2012 Nico Burns

Description:       An open source JavaScript WYSIWYG editor focused on usability
Homepage:          http://ghosted.it
License:           LGPL
Author:            Nico Burns <nico@nicoburns.com>
Version:           1.0rc1-pre
Release Date:      2012-12-15
Browser Support:   Internet Explorer 6+, Mozilla Firefox 3.6+, Google Chrome, Apple Safari (latest), Opera (latest)
*/
(function(){var e={aelem:!1,context:null},t=window.ghostedit;e.el={},e.enable=function(){t.event.trigger("ui:replace"),t.event.addListener("ui:update",function(){e.update()},"minimalui"),t.event.addListener("ui:replace",function(){t.api.plugin.disable("minimalui")},"minimalui");var n,r,i,s=!1,o=!1;n=document.createElement("div"),n.id="ghostedit_minimalui_toolbar",n.className="ghostedit_minimalui_toolbar",e.el.toolbar=n,e.insertbutton({label:"Bold",icon:"format-bold.png",action:function(){t.api.format.bold()}}),e.insertbutton({label:"Italic",icon:"format-italic.png",action:function(){t.api.format.italic()}}),e.insertbutton({label:"Underline",icon:"format-underline.png",action:function(){t.api.format.underline()}}),e.insertbutton({label:"Strikethrough",icon:"format-strikethrough.png",action:function(){t.api.format.strikethrough()}}),e.insertbutton({label:"Align Left",icon:"align-left.png",action:function(){t.api.format.alignText("left")}}),e.insertbutton({label:"Align Center",icon:"align-center.png",action:function(){t.api.format.alignText("center")}}),e.insertbutton({label:"Align Right",icon:"align-right.png",action:function(){t.api.format.alignText("right")}}),e.insertbutton({label:"Justify",icon:"align-justified.png",action:function(){t.api.format.alignText("justify")}}),r=t.options.plugins;if(r)for(i=0;i<r.length;i++)switch(r[i]){case"link":s=!0;break;case"list":o=!0}s&&e.insertbutton({label:"Insert Link",icon:"insert-link.png",action:function(){t.api.link.create()}}),o&&(e.insertbutton({label:"Bulleted List",icon:"list-unordered.png",action:function(){t.api.list.toggle("unordered")}}),e.insertbutton({label:"Numbered List",icon:"list-ordered.png",action:function(){t.api.list.toggle("ordered")}})),e.insertbutton({label:"Undo",icon:"undo16.png",action:function(){t.api.undo()}}),e.insertbutton({label:"Redo",icon:"redo16.png",action:function(){t.api.redo()}}),t.wrapdiv.insertBefore(n,t.wrapdiv.firstChild),t.util.addEvent(e.el.toolbar,"mouseup",t.util.cancelAllEvents),t.util.addEvent(e.el.toolbar,"click",t.util.preventBubble),t.util.addEvent(e.el.toolbar,"mousedown",t.util.preventBubble)},e.disable=function(){t.event.removeAllListeners("minimalui"),t.wrapdiv.removeChild(e.el.toolbar)},e.update=function(){var n,r,i,s,o,u;u=e.highlightmap;for(n=0;n<u.length;n++)t.util.removeClass(u[n].element,"current");for(n=0;n<t.selection.nodepath.length;n++){i=t.selection.nodepath[n],s=i.tagName.toLowerCase(),o=t.util.trim(i.className);for(r=0;r<u.length;r++)u[r].test.call(u[r].data,s,o,i)&&t.util.addClass(u[r].element,"current")}},e.quickbuttons=[],e.highlightmap=[],e.insertbutton=function(n){var r;if(!n||!n.label||!n.icon||!t.util.isFunction(n.action))return!1;r=document.createElement("img"),r.src=t.options.imageurl+"/minimalui/"+n.icon,r.title=n.label,r.alt=n.label,n.style&&(r.style.cssText=n.style),r.style.marginRight="5px",e.el.toolbar.appendChild(r),n.highlighttest&&e.highlightmap.push({element:r,test:n.highlighttest}),t.util.addEvent(r,"click",n.action)},e.inserttextfield=function(e,n){var r;r=document.createElement("input"),n.id&&(r.id="ghostedit_minimalui_textfield_"+n.id),r.style.width=n.width?n.width:"200px",n.label&&(e.innerHTML+=n.label+"<br />"),e.appendChild(r),t.util.addEvent(r,"click",function(e){t.util.preventBubble(e)}),t.util.addEvent(r,"keypress",function(e){t.util.preventBubble(e)}),t.util.addEvent(r,"keydown",function(e){t.util.preventBubble(e)}),t.util.addEvent(r,"keyup",n.onkeyup)},e.insertstylebox=function(n,r){var i;e.highlightmap.push({element:i,data:{tagname:r.tagname,classname:r.classname!==undefined?r.classname:""},test:function(e,t){return e===this.tagname&&t===this.classname}}),i.onclick=function(){t.api.format.setStyle(r.tagname,r.classname)}},t.api.plugin.register("minimalui",e)})();