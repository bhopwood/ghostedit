/*! GhostEdit WYSIWYG editor Copyright (c) 2010-2012 Nico Burns

Description:       An open source JavaScript WYSIWYG editor focused on usability
Homepage:          http://ghosted.it
License:           LGPL
Author:            Nico Burns <nico@nicoburns.com>
Version:           1.0rc1-pre
Release Date:      2012-12-18
Browser Support:   Internet Explorer 6+, Mozilla Firefox 3.6+, Google Chrome, Apple Safari (latest), Opera (latest)
*/
(function(e,t){var n={savename:"",saveurl:"",params:[]},r=e.ghostedit;n.enable=function(){var e,t,i;r.api.save=function(){n.save()};if(r.options.save&&r.options.save.params){t=r.options.save.params;for(e=0;e<t.length;e++){if(typeof t[e]!="string")continue;i=t[e].split("=",2),i.length>1&&n.updateparameter(i[0],i[1])}}},n.save=function(){var e,t,i,s;t=r.api.exportHTML(),n.updateparameter("snippet",t.snippet),n.updateparameter("content",t.content),i=[];for(e=0;e<n.params.length;e++)i.push(n.params[e].name+"="+n.params[e].value);i=i.join("&"),s=function(e,t){var n;e&&t==="true"?r.event.trigger("ui:message",{message:"Page was successfully saved :)",time:1,color:"success"}):(n=t,r.event.trigger("ui:message",{message:n,time:1,color:"error"}))},r.util.ajax(r.options.save.url,"POST",i,s,"text")},n.updateparameter=function(e,t){var r;if(typeof e!="string"||typeof t!="string")return;e=e.replace(/[^A-Za-z\-_0-9]/g,""),t=encodeURIComponent(t);for(r=0;r<n.params.length;r++)if(n.params[r].name===e){n.params[r]={name:e,value:t};return}n.params.push({name:e,value:t})},r.api.plugin.register("save",n)})(window);