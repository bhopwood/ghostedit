/*! GhostEdit WYSIWYG editor Copyright (c) 2010-2012 Nico Burns

Description:       An open source JavaScript WYSIWYG editor focused on usability
Homepage:          http://ghosted.it
License:           LGPL
Author:            Nico Burns <nico@nicoburns.com>
Version:           1.0rc1
Release Date:      2012-12-13
Browser Support:   Internet Explorer 6+, Mozilla Firefox 3.6+, Google Chrome, Apple Safari (latest), Opera (latest)
*/
(function(e,t){var n={savename:"",saveurl:"",params:[]};n.enable=function(){var e,t,r;ghostedit.api.save=function(){n.save()};if(ghostedit.options.save&&ghostedit.options.save.params){t=ghostedit.options.save.params;for(e=0;e<t.length;e++){if(typeof t[e]!="string")continue;r=t[e].split("=",2),r.length>1&&n.updateparameter(r[0],r[1])}}},n.save=function(){var e,t,r,i;t=ghostedit.api.exportHTML(),n.updateparameter("snippet",t.snippet),n.updateparameter("content",t.content),r=[];for(e=0;e<n.params.length;e++)r.push(n.params[e].name+"="+n.params[e].value);r=r.join("&"),i=function(e,t){var n;e&&t==="true"?ghostedit.event.trigger("ui:message",{message:"Page was successfully saved :)",time:1,color:"success"}):(n=t,ghostedit.event.trigger("ui:message",{message:n,time:1,color:"error"}))},ghostedit.util.ajax(ghostedit.options.save.url,"POST",r,i,"text")},n.updateparameter=function(e,t){var r;if(typeof e!="string"||typeof t!="string")return;e=e.replace(/[^A-Za-z\-_0-9]/g,""),t=encodeURIComponent(t);for(r=0;r<n.params.length;r++)if(n.params[r].name===e){n.params[r]={name:e,value:t};return}n.params.push({name:e,value:t})},ghostedit.api.plugin.register("save",n)})(window);